type LocaleKey = 'en' | 'zh-CN';

declare global {
  interface Window {
    __LOCALE__?: string;
  }
}

const messages: Record<LocaleKey, Record<string, string>> = {
  en: {
    'tab.installed': 'Installed',
    'tab.marketplace': 'Marketplace',
    'tab.marketSettings': 'Market Settings',
    'errorBoundary.title': 'Something went wrong!',
    'installed.loading': 'Loading installed skills...',
    'installed.empty.title': 'No Skills Installed',
    'installed.empty.desc': 'Install skills from the marketplace to enhance your workflow.',
    'installed.empty.browse': 'Browse Marketplace',
    'installed.scope.global': 'Show global skills',
    'installed.scope.toggle': 'Toggle global skills visibility',
    'installed.checkUpdates': 'Check Updates',
    'installed.checking': 'Checking...',
    'market.search.placeholder': "Search for skills (e.g., 'git', 'testing', 'debugging')",
    'market.search.aria': 'Search skills',
    'market.search.button': 'Search',
    'market.leaderboard.allTime': 'All Time',
    'market.leaderboard.trending': 'Trending (24h)',
    'market.leaderboard.hot': 'Hot',
    'market.leaderboard.empty.title': 'No Skills In This Leaderboard',
    'market.leaderboard.empty.desc': 'Try another leaderboard tab or use search.',
    'market.leaderboard.loadMore': 'Load more',
    'market.leaderboard.loadingMore': 'Loading...',
    'market.loading': 'Searching marketplace...',
    'market.error.default': 'Search failed. Please try again.',
    'market.error.dismiss': 'Dismiss',
    'market.empty.before.title': 'Discover Skills',
    'market.empty.before.desc': 'Search the marketplace to find and install skills for your agents.',
    'market.empty.before.popular': 'Popular searches:',
    'market.empty.none.title': 'No Results Found',
    'market.empty.none.desc': 'Try different keywords or check your spelling.',
    'card.menu.actions': 'Actions',
    'card.menu.openDoc': 'Open Documentation',
    'card.menu.update': 'Update',
    'card.menu.reinstall': 'Reinstall',
    'card.menu.remove': 'Remove',
    'card.menu.install': 'Install',
    'card.menu.repo': 'Open Repository',
    'card.installed': 'Installed',
    'card.updateAvailable': 'Update available',
    'card.installs': 'installs',
    'market.settings.title': 'Market Settings',
    'market.settings.desc': 'Manage marketplace endpoints and apply changes instantly.',
    'market.settings.add': 'Add Market',
    'market.settings.save': 'Save',
    'market.settings.savedState': 'Saved',
    'market.settings.saving': 'Saving...',
    'market.settings.saveSuccess': 'Saved and applied.',
    'market.settings.saveError': 'Failed to save',
    'market.settings.test': 'Test',
    'market.settings.testing': 'Testing...',
    'market.settings.testNeedUrl': 'Please enter base URL before testing.',
    'market.settings.delete': 'Delete',
    'market.settings.empty': 'No market configured. Add one to start.',
    'market.settings.unnamed': 'Market',
    'market.settings.namePlaceholder': 'Optional name',
    'market.settings.duplicateWarning': 'Duplicate base URLs detected. Please keep each endpoint unique before saving.',
    'market.settings.duplicateInline': 'This URL is duplicated in another row.',
    'market.settings.health.ok': 'Healthy',
    'market.settings.health.pending': 'Untested',
    'market.settings.status.enabled': 'Enabled',
    'market.settings.status.disabled': 'Disabled',
    'market.settings.overview.total': 'Total Markets',
    'market.settings.overview.enabled': 'Enabled',
    'market.settings.overview.healthy': 'Healthy',
    'market.settings.overview.tested': 'Tested',
    'market.settings.col.enabled': 'Enabled',
    'market.settings.col.name': 'Name',
    'market.settings.col.url': 'Base URL',
    'market.settings.col.priority': 'Priority',
    'market.settings.col.actions': 'Actions'
  },
  'zh-CN': {
    'tab.installed': '已安装',
    'tab.marketplace': '市场',
    'tab.marketSettings': '市场设置',
    'errorBoundary.title': '页面发生错误',
    'installed.loading': '正在加载已安装技能...',
    'installed.empty.title': '暂无已安装技能',
    'installed.empty.desc': '可从市场安装技能来增强你的工作流。',
    'installed.empty.browse': '浏览市场',
    'installed.scope.global': '显示全局技能',
    'installed.scope.toggle': '切换全局技能显示',
    'installed.checkUpdates': '检查更新',
    'installed.checking': '检查中...',
    'market.search.placeholder': "搜索技能（例如 'git'、'testing'、'debugging'）",
    'market.search.aria': '搜索技能',
    'market.search.button': '搜索',
    'market.leaderboard.allTime': '累计安装',
    'market.leaderboard.trending': '24h 趋势',
    'market.leaderboard.hot': '热门',
    'market.leaderboard.empty.title': '该榜单暂无数据',
    'market.leaderboard.empty.desc': '可以切换其他榜单或直接搜索。',
    'market.leaderboard.loadMore': '加载更多',
    'market.leaderboard.loadingMore': '加载中...',
    'market.loading': '正在搜索市场...',
    'market.error.default': '搜索失败，请重试。',
    'market.error.dismiss': '关闭',
    'market.empty.before.title': '发现技能',
    'market.empty.before.desc': '在市场中搜索并安装适用于你的 Agent 的技能。',
    'market.empty.before.popular': '热门搜索：',
    'market.empty.none.title': '未找到结果',
    'market.empty.none.desc': '试试其他关键词或检查拼写。',
    'card.menu.actions': '操作',
    'card.menu.openDoc': '打开文档',
    'card.menu.update': '更新',
    'card.menu.reinstall': '重新安装',
    'card.menu.remove': '卸载',
    'card.menu.install': '安装',
    'card.menu.repo': '查看仓库',
    'card.installed': '已安装',
    'card.updateAvailable': '可更新',
    'card.installs': '安装',
    'market.settings.title': '市场设置',
    'market.settings.desc': '管理市场地址并立即生效。',
    'market.settings.add': '新增市场',
    'market.settings.save': '保存',
    'market.settings.savedState': '已保存',
    'market.settings.saving': '保存中...',
    'market.settings.saveSuccess': '已保存并生效。',
    'market.settings.saveError': '保存失败',
    'market.settings.test': '测试',
    'market.settings.testing': '测试中...',
    'market.settings.testNeedUrl': '请先填写基础 URL。',
    'market.settings.delete': '删除',
    'market.settings.empty': '暂无市场配置，请先新增。',
    'market.settings.unnamed': '市场',
    'market.settings.namePlaceholder': '可选名称',
    'market.settings.duplicateWarning': '检测到重复的基础 URL，保存前请保证每个市场地址唯一。',
    'market.settings.duplicateInline': '该 URL 与其他条目重复。',
    'market.settings.health.ok': '健康',
    'market.settings.health.pending': '待测试',
    'market.settings.status.enabled': '已启用',
    'market.settings.status.disabled': '已停用',
    'market.settings.overview.total': '市场总数',
    'market.settings.overview.enabled': '已启用',
    'market.settings.overview.healthy': '健康数量',
    'market.settings.overview.tested': '已测试',
    'market.settings.col.enabled': '启用',
    'market.settings.col.name': '名称',
    'market.settings.col.url': '基础 URL',
    'market.settings.col.priority': '优先级',
    'market.settings.col.actions': '操作'
  }
};

function resolveLocale(): LocaleKey {
  const locale = (window.__LOCALE__ || '').toLowerCase();
  return locale.startsWith('zh') ? 'zh-CN' : 'en';
}

export function t(key: string): string {
  const locale = resolveLocale();
  return messages[locale][key] || messages.en[key] || key;
}
